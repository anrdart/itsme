const THEME_CONFIG={blueTheme:{id: 'color-3',name: 'Blue',hex: '#1fabeb',rgb: '31,171,237'},localStorageKeys:{darkMode: 'theme-dark'}};(function(){document.addEventListener('DOMContentLoaded',function(){initializeTheme();setupEventListeners();setupContactForm();hideThemeColorSelectors()});applyThemeImmediately()})();function applyThemeImmediately(){try{const isDark=localStorage.getItem(THEME_CONFIG.localStorageKeys.darkMode)==='true';if(isDark){document.body.classList.add('dark')}const themeLink=document.createElement('link');themeLink.rel='stylesheet';themeLink.href='css/skins/color-3.css';themeLink.className='active-theme-style';document.head.appendChild(themeLink);document.documentElement.style.setProperty('--skin-color',`rgb(${THEME_CONFIG.blueTheme.rgb})`);document.documentElement.style.setProperty('--skin-color-rgb',THEME_CONFIG.blueTheme.rgb)}catch(error){console.error('Error applying immediate theme:',error)}}function initializeTheme(){try{const isDark=localStorage.getItem(THEME_CONFIG.localStorageKeys.darkMode)==='true';updateDarkModeUI(isDark)}catch(error){console.error('Error initializing theme:',error)}}function hideThemeColorSelectors(){const themeColorSection=document.querySelector('.style-switcher h4');if(themeColorSection){themeColorSection.style.display='none'}const colorSelectors=document.querySelector('.style-switcher .colors');if(colorSelectors){colorSelectors.style.display='none'}}function setupEventListeners(){try{const styleSwitcherToggle=document.querySelector('.style-switcher-toggler');const styleSwitcher=document.querySelector('.style-switcher');if(styleSwitcherToggle && styleSwitcher){styleSwitcherToggle.addEventListener('click',function(){styleSwitcher.classList.toggle('open')});window.addEventListener('scroll',function(){if(styleSwitcher.classList.contains('open')){styleSwitcher.classList.remove('open')}})}const dayNightBottom=document.querySelector('.theme-controls-bottom .day-night-bottom');if(dayNightBottom){dayNightBottom.addEventListener('click',function(){toggleDarkMode()})}if(window.location.search.includes('theme')|| window.location.search.includes('dark')){const url=new URL(window.location.href);url.searchParams.delete('theme');url.searchParams.delete('dark');window.history.replaceState({},document.title,url.toString())}}catch(error){console.error('Error setting up event listeners:',error)}}function setupContactForm(){try{const contactForm=document.getElementById('contactForm');if(!contactForm)return;contactForm.addEventListener('submit',function(e){e.preventDefault();const isDarkTheme=document.body.classList.contains('dark');const activeSkin=localStorage.getItem(THEME_CONFIG.localStorageKeys.activeStyle)|| THEME_CONFIG.defaultColor;contactForm.action='https://formsubmit.co/ekalliptus@gmail.com';contactForm.method='POST';const hiddenFields=[{name: '_subject',value: 'Pesan Baru dari Website Portfolio'},{name: '_captcha',value: 'false'},{name: '_template',value: 'table'},{name: '_next',value: `${window.location.origin}${window.location.pathname.replace('index.html','')}success.html?theme=${activeSkin}&dark=${isDarkTheme}`}];contactForm.querySelectorAll('input[type="hidden"]').forEach(input=>{if(['_subject','_captcha','_template','_next'].includes(input.name)){input.remove()}});hiddenFields.forEach(field=>{const input=document.createElement('input');input.type='hidden';input.name=field.name;input.value=field.value;contactForm.appendChild(input)});const sendingPopup=document.getElementById('sendingPopup');if(sendingPopup){sendingPopup.classList.add('active')}setTimeout(()=>{contactForm.submit()},500)})}catch(error){console.error('Error setting up contact form:',error)}}function updateDarkModeUI(isDark){try{const dayNightBottom=document.querySelector('.theme-controls-bottom .day-night-bottom');if(!dayNightBottom)return;const icon=dayNightBottom.querySelector('i');if(!icon)return;if(isDark){icon.classList.remove('fa-moon');icon.classList.add('fa-sun')}else{icon.classList.remove('fa-sun');icon.classList.add('fa-moon')}}catch(error){console.error('Error updating dark mode UI:',error)}}//Dummy function to prevent errors in case it's called from HTML function setActiveStyle(colorId){//This function is intentionally left empty as we're using fixed blue theme console.log('Theme color selection is disabled,using fixed blue theme');return}function toggleDarkMode(){try{const isDarkTheme=document.body.classList.contains('dark');if(isDarkTheme){document.body.classList.remove('dark');localStorage.setItem(THEME_CONFIG.localStorageKeys.darkMode,'false')}else{document.body.classList.add('dark');localStorage.setItem(THEME_CONFIG.localStorageKeys.darkMode,'true')}updateDarkModeUI(!isDarkTheme)}catch(error){console.error('Error toggling dark mode:',error)}}function initDropdown(){const hamburgerBtn=document.querySelector('.hamburger-btn');const dropdownMenu=document.querySelector('.dropdown-menu');if(!hamburgerBtn || !dropdownMenu){console.error('Dropdown menu elements not found!');return}const menuLinks=document.querySelectorAll('.dropdown-menu .link-item');const newHamburgerBtn=hamburgerBtn.cloneNode(true);hamburgerBtn.parentNode.replaceChild(newHamburgerBtn,hamburgerBtn);const refreshedHamburgerBtn=document.querySelector('.hamburger-btn');refreshedHamburgerBtn.addEventListener('click',function(e){e.stopPropagation();refreshedHamburgerBtn.classList.toggle('active');dropdownMenu.classList.toggle('open')});menuLinks.forEach(link=>{link.addEventListener('click',function(e){e.preventDefault();const btn=document.querySelector('.hamburger-btn');const menu=document.querySelector('.dropdown-menu');btn.classList.remove('active');menu.classList.remove('open');const targetHash=this.getAttribute('href');setTimeout(()=>{const currentActive=document.querySelector('.section.active');if(currentActive){currentActive.classList.remove('active');currentActive.classList.add('hide')}const targetSection=document.querySelector(targetHash);if(targetSection){targetSection.classList.add('active');targetSection.classList.remove('hide');targetSection.scrollIntoView({behavior: 'smooth'});window.location.hash=targetHash;const allMenuLinks=document.querySelectorAll('.dropdown-menu .link-item');allMenuLinks.forEach(item=>{item.classList.remove('active','inner-shadow');item.classList.add('outer-shadow','hover-in-shadow')});const activeLink=document.querySelector(`.dropdown-menu .link-item[href="${targetHash}"]`);if(activeLink){activeLink.classList.add('active','inner-shadow');activeLink.classList.remove('outer-shadow','hover-in-shadow')}}},300)})});document.addEventListener('click',function(e){const btn=document.querySelector('.hamburger-btn');const menu=document.querySelector('.dropdown-menu');const cvDropdown=document.querySelector('.cv-dropdown');const cvDropdownBtn=document.querySelector('.cv-dropdown-btn');if(cvDropdown &&(cvDropdown.contains(e.target)||(cvDropdownBtn && cvDropdownBtn.contains(e.target)))){return}if(menu && btn && !menu.contains(e.target)&& !btn.contains(e.target)){btn.classList.remove('active');menu.classList.remove('open')}});function setActiveMenuItem(){const sections=document.querySelectorAll('.section');const links=document.querySelectorAll('.dropdown-menu .link-item');sections.forEach(section=>{if(section.classList.contains('active')){const id=section.getAttribute('id');links.forEach(link=>{link.classList.remove('active','inner-shadow');link.classList.add('outer-shadow','hover-in-shadow')});const activeLink=document.querySelector(`.dropdown-menu .link-item[href="#${id}"]`);if(activeLink){activeLink.classList.add('active','inner-shadow');activeLink.classList.remove('outer-shadow','hover-in-shadow')}}})}window.addEventListener('load',setActiveMenuItem);document.addEventListener('sectionChange',setActiveMenuItem)}document.addEventListener('DOMContentLoaded',initDropdown);window.addEventListener('hashchange',function(){setTimeout(initDropdown,100)});if(typeof FORMSUBMIT_CONFIG==='undefined'){console.error('FORMSUBMIT_CONFIG not found. Make sure config.js is loaded before email-handler.js')}document.addEventListener('DOMContentLoaded',function(){console.log('FormSubmit.co email handler initialized')});function sendEmail(formData){const{name,email,subject,message}=formData;const formSubmitData={name: name,email: email,subject: subject,message: message,_subject: `Portfolio Contact: ${subject}`,_template: 'table',_captcha: 'false'};return fetch(FORMSUBMIT_CONFIG.endpoint,{method: 'POST',headers:{'Content-Type': 'application/json','Accept': 'application/json'},body: JSON.stringify(formSubmitData)}).then(response=>{if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`)}return response.json()}).then(data=>{console.log('FormSubmit Success:',data);return 'OK'}).catch(error=>{console.error('FormSubmit Error:',error);throw error})}function createEmailPopup(){const popupHTML=` <div id="email-popup" class="email-popup"> <div class="email-popup-content"> <div class="email-popup-header"> <h3 id="email-popup-title">Sending Message</h3> <button class="email-popup-close" onclick="closeEmailPopup()">&times;</button> </div> <div class="email-popup-body"> <div id="email-popup-message">Sending your message...</div> </div> <div class="email-popup-footer"> <button id="email-popup-close-btn" class="btn btn-primary" onclick="closeEmailPopup()">Close</button> </div> </div> </div> `;if(!document.getElementById('email-popup')){document.body.insertAdjacentHTML('beforeend',popupHTML)}if(!document.getElementById('email-popup-styles')){const style=document.createElement('style');style.id='email-popup-styles';style.textContent=` .email-popup{display: none;position: fixed;top: 0;left: 0;width: 100%;height: 100%;background-color: rgba(0,0,0,0.5);z-index: 1000;animation: fadeIn 0.3s ease-in-out}.email-popup.active{display: flex;align-items: center;justify-content: center}.email-popup-content{background: var(--bg-color);border: 1px solid var(--border-color);border-radius: 12px;padding: 2rem;max-width: 400px;width: 90%;box-shadow: 0 10px 30px rgba(0,0,0,0.3);animation: slideIn 0.3s ease-in-out}.email-popup-header{display: flex;justify-content: space-between;align-items: center;margin-bottom: 1rem;border-bottom: 1px solid var(--border-color);padding-bottom: 0.5rem}.email-popup-close{background: none;border: none;font-size: 1.5rem;cursor: pointer;color: var(--text-color);padding: 0;width: 30px;height: 30px;display: flex;align-items: center;justify-content: center;border-radius: 50%;transition: background-color 0.3s}.email-popup-close:hover{background-color: var(--border-color)}.email-popup-body{margin-bottom: 1.5rem;text-align: center}.email-popup-footer{text-align: center}@keyframes fadeIn{from{opacity: 0}to{opacity: 1}}@keyframes slideIn{from{transform: translateY(-50px);opacity: 0}to{transform: translateY(0);opacity: 1}}.email-success{color: #10b981;font-weight: 600}.email-error{color: #ef4444;font-weight: 600}`;document.head.appendChild(style)}}function showEmailPopup(title,message,isSuccess=false){createEmailPopup();const popup=document.getElementById('email-popup');const titleEl=document.getElementById('email-popup-title');const messageEl=document.getElementById('email-popup-message');titleEl.textContent=title;messageEl.innerHTML=`<p class="${isSuccess ? 'email-success' : 'email-error'}">${message}</p>`;popup.classList.add('active')}function closeEmailPopup(){const popup=document.getElementById('email-popup');if(popup){popup.classList.remove('active')}}function initContactForm(){const contactForm=document.getElementById('contact-form');if(!contactForm)return;contactForm.addEventListener('submit',function(e){e.preventDefault();showEmailPopup('Sending Message','Sending your message...');const formData={name: document.getElementById('name')?.value || '',email: document.getElementById('email')?.value || '',subject: document.getElementById('subject')?.value || 'Portfolio Contact',message: document.getElementById('message')?.value || ''};sendEmail(formData).then(function(response){console.log('Email response:',response);if(response==='OK'){showEmailPopup('Success!','Thank you for your message! Redirecting...',true);contactForm.reset();setTimeout(()=>{window.location.href='/'},700)}else{showEmailPopup('Error','There was an error sending your message. Please try again.');console.error('Email sending failed:',response)}}).catch(function(error){showEmailPopup('Error','There was an error sending your message. Please try again.');console.error('Email sending error:',error)})})}document.addEventListener('DOMContentLoaded',initContactForm);